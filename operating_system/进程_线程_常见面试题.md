## 进程*线程*常见面试题

https://blog.csdn.net/fluetty/article/details/108719449?spm=1001.2101.3001.6650.1&utm_medium=distribute.pc_relevant.none-task-blog-2%7Edefault%7ECTRLIST%7Edefault-1.no_search_link&depth_1-utm_source=distribute.pc_relevant.none-task-blog-2%7Edefault%7ECTRLIST%7Edefault-1.no_search_link

### Process vs Thread 进程与线程之间有什么区别

1. 程序: 说起进程,就不得不说下程序。程序是指令和数据的有序集合,其本身没有任何运行的含义,是一个静态的概念。
2. 进程: 而进程则是执行程序的一次执行过程,它是一个动态的概念。是系统进行资源分配的基本单位，是操作系统结构的基础。
3. 线程: 通常在一个进程中可以包含若千个线程,当然一个进程中至少有一个线程,不然没有存在的意义。线程是 CPU 调度和执行的的单位。一条线程指的是进程中一个单一顺序的控制流，一个进程中可以并发多个线程，每条线程并行执行不同的任务。

**注意**:很多多线程是模拟出来的,真正的多线程是指有多个 cpu,即多核,如服务 。如果是模拟出来的多线程,即在一个 cpu 的情况下,在同一个时间点,cpu 只能 执行一个代码,因为切换的很快,所以就有同时执行的错局。

**进程和线程的主要差别在于它们是不同的操作系统资源管理方式。**

1. 进程是操作系统资源分配的最小单位，线程是 CPU 任务调度的最小单位。一个进程可以包含多个线程。
2. 不同进程间数据很难共享，同一进程下不同线程间数据很易共享。
3. 每个进程都有独立的代码和数据空间，进程要比线程消耗更多的计算机资源，一个进程崩溃后，在保护模式下不会对其它进程产生影响。线程可以看做轻量级的进程，同一类线程共享代码和数据空间，每个线程都有自己独立的 stack 运行栈和 program counter 程序计数器，线程之间切换的开销小，但线程之间没有单独的**地址空间**，一个线程死掉就等于整个进程死掉，所以多进程的程序要比多线程的程序健壮，但在进程切换时，耗费资源较大，效率要差一些。但对于一些要求同时进行并且又要共享某些变量的并发操作，只能用线程，不能用进程。

## 进程的结构 = 线程+内存+file descriptor/handles

进程 = 线程 + Memory (typically some region of virtual memory) _逻辑内存_ +file descriptor/handles(windows) _文件/网络句柄_

- “内存”：  
  我们通常所理解的内存是我们所见到的(2G/4G/8G/16G)物理内存，这里的内存是逻辑内存。指的是内存的 adress space。每个进程的内存是相互独立的。（否则：我们把指针的值改一改就指向其他进程的内存了，通过这样我们岂不是就可以看到其他进程中"微信"或者是"网上银行"的信息）

- “file descriptor/handles”  
  它们是所有的进程所共有的，例如打开同一个文件，去抢同一个网络的端口这样的操作是被允许的。

## 线程的结构 = (栈+PC+TLS)

- 栈  
  用来储存函数的参数和返回的地址

- Program Counter Register 程序计数器
  操作系统真正运行的是一个个的线程， 而我们的进程只是它的一个容器 每个线程都有一串自己的指针，去指向自己当前所在内存的指针

- TLS **(thread local storage)**  
  线程自己独立的内存

## 线程的通信方式 -->> 主要用于线程的同步

- 互斥锁 Mutual exclusion (Mutex)  
  防止多线程同时读写同一块区域，保证资源独占

- 信号量 semophore  
  允许同一时刻多个线程访问同一资源，但是需要控制同一时刻访问此资源的最大线程数量。一旦大于限制的数量，其他线程只能等待

- 信号 signal  
  通过通知操作的方式来保持多线程同步，还可以方便的实现多线程优先级的比较操作。

参考：线程同步的几种方式->https://www.cnblogs.com/sherlock-lin/p/14538083.html

## 常用 linux 查看进程/线程状态的命令行

1. ps

   **ps 命令行的 documentation page**: https://man7.org/linux/man-pages/man1/ps.1.html

   1. ` ps -a - 列出所有运行中/激活进程`

### 参考
