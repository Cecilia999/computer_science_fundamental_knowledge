# process scheduling 进程调度

程序调度指的是，决定哪个进程优先被运行和运行多久，这是很重要的一点。已经设计出许多算法来尝试平衡系统整体效率与各个流程之间的竞争需求。

调度算法分为三大类：批处理中的调度、交互系统中的调度、实时系统中的调度

### 批处理中的调度

批处理作业调度，就是对于给定的 n 个作业, 制定最佳作业调度方案,使其完成时间和达到最小.

1. [first-come-first-serve 先来先服务](https://juejin.cn/post/6934500044057870350#heading-36)

- 优点：易于编程和理解，用一个单链表记录所有就绪进程。
  - 要选取一个进程运行，只要从该队列的头部移走一个进程即可；
  - 要添加一个新的作业或者阻塞一个进程，只要把这个作业或进程附加在队列的末尾即可。
- 缺点：**没有优先级**

2. Shortest Job First 最短作业优先

   需要注意的是，在所有的进程都可以运行的情况下，最短作业优先的算法才是最优的。

3. Shortest Remaining Time Next 最短剩余时间优先

### 交互式系统中的调度

1. round-robin 轮询调度

   每个进程都会被分配一个时间段，称为**quantum**时间片，在这个时间片内允许进程运行。  
   如果时间片结束时进程还在运行的话，则抢占一个 CPU 并将其分配给另一个进程。  
   如果进程在时间片结束前阻塞或结束，则 CPU 立即进行切换。

2. priority scheduling 优先级调度

   给每个进程一个优先级，优先级高的先执行  
   但高优先级不会一直保存，调度程序会在每个时钟中断期间降低当前运行进程的优先级，当当前运行进程的优先级被降低到下一个最高进程的优先级以下，则会发送进程切换  
   或者，可以为每个进程分配允许运行的最大时间间隔。当时间间隔用完后，下一个高优先级的进程会得到运行的机会

3. [shortest process first 最短进程优先](https://juejin.cn/post/6934500044057870350#heading-42)

   约等于批处理系统的最短作业优先

4. lottery scheduling 彩票调度

   为进程提供各种系统资源的彩票。当做出一个调度决策的时候，就随机抽出一张彩票，拥有彩票的进程将获得资源

5. fair share scheduling 公平分享调度

   如果用户 1 启动了 9 个进程，而用户 2 启动了一个进程，使用轮转或优先级调度算法，那么用户 1 将得到 90 % 的 CPU 时间，而用户 2 将之得到 10 % 的 CPU 时间。

   为了阻止这种情况的出现，一些系统在调度前会把进程的拥有者考虑在内。  
   在这种模型下，每个用户都会分配一些 CPU 时间，而调度程序会选择进程并强制执行。因此如果两个用户每个都会有 50% 的 CPU 时间片保证，那么无论一个用户有多少个进程，都将获得相同的 CPU 份额。

### 影响调度程序的指标是什么

- CPU 使用率: CPU 正在执行任务（即不处于空闲状态）的时间百分比
- 等待时间: 进程轮流执行的时间，也就是进程切换的时间
- 吞吐量: 单位时间内完成进程的数量
- 响应时间: 这是从提交流程到获得有用输出所经过的时间
- 周转时间: 从提交流程到完成流程所经过的时间

### 参考

https://juejin.cn/post/6934500044057870350#heading-34
https://blog.csdn.net/qq_35642036/article/details/82809812
