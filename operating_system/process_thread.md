# Process VS Thread

### 1. 进程与线程之间有什么区别

- 进程：进程是程序的实体，指在系统中正在运行的一个应用程序；程序一旦运行就是进程；是系统进行资源分配和调度的基本单位，是操作系统结构的基础。
- 线程：是进程中的实际运作单位，程序执行的最小单位，一条线程指的是进程中一个单一顺序的控制流，一个进程中可以并发多个线程，每条线程并行执行不同的任务。

**进程和线程的主要差别在于它们是不同的操作系统资源管理方式。**

1. 进程是操作系统资源分配的最小单位，线程是 CPU 任务调度的最小单位。一个进程可以包含多个线程。
2. 不同进程间数据很难共享，同一进程下不同线程间数据很易共享。
3. 每个进程都有独立的代码和数据空间，进程要比线程消耗更多的计算机资源，一个进程崩溃后，在保护模式下不会对其它进程产生影响。线程可以看做轻量级的进程，同一类线程共享代码和数据空间，每个线程都有自己独立的 stack 运行栈和 program counter 程序计数器，线程之间切换的开销小，但线程之间没有单独的**地址空间**，一个线程死掉就等于整个进程死掉，所以多进程的程序要比多线程的程序健壮，但在进程切换时，耗费资源较大，效率要差一些。但对于一些要求同时进行并且又要共享某些变量的并发操作，只能用线程，不能用进程。

### 2. 进程的结构 = 线程+内存+文件/网络句柄

进程 = 线程 + Memory (typically some region of virtual memory) _逻辑内存_ +file descriptor/handles(windows) _文件/网络句柄_

- “内存”：    
  我们通常所理解的内存是我们所见到的(2G/4G/8G/16G)物理内存，这里的内存是逻辑内存。指的是内存的寻址空间。每个进程的内存是相互独立的。（否则：我们把指针的值改一改就指向其他进程的内存了，通过这样我们岂不是就可以看到其他进程中"微信"或者是"网上银行"的信息）

- “文件/网络句柄”     
  它们是所有的进程所共有的，例如打开同一个文件，去抢同一个网络的端口这样的操作是被允许的。

### 3. 线程的结构 = (栈+PC+TLS)

- 栈    
  用来储存函数的参数和返回的地址

- Program Counter    
  操作系统真正运行的是一个个的线程， 而我们的进程只是它的一个容器 每个线程都有一串自己的指针，去指向自己当前所在内存的指针

- TLS **(thread local storage)**      
  线程自己独立的内存

### 4. 线程的通信方式 -->> 主要用于线程的同步

- 互斥锁 Mutual exclusion (Mutex)    
  防止多线程同时读写同一块区域，保证资源独占

- 信号量 semophore    
  允许同一时刻多个线程访问同一资源，但是需要控制同一时刻访问此资源的最大线程数量。一旦大于限制的数量，其他线程只能等待

- 信号 signal     
  通过通知操作的方式来保持多线程同步，还可以方便的实现多线程优先级的比较操作。

参考：线程同步的几种方式->https://www.cnblogs.com/sherlock-lin/p/14538083.html

### 5. [进程的通信方式](interprocess_communication.md)

### 参考

- 线程与进程简单的解释： http://www.ruanyifeng.com/blog/2013/04/processes_and_threads.html    
- 线程与进程的联系：https://juejin.cn/post/6844903801321685000   
- Processes and Threads：http://www.qnx.com/developers/docs/6.4.1/neutrino/getting_started/s1_procs.html   
